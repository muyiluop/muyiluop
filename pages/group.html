<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>抽签</title>
  </head>
  <body>
    <textarea
      id="users"
      cols="30"
      rows="10"
      value=""
      placeholder="输入人员，每行一个"
    ></textarea>
    <br />
    <input
      id="group"
      value="2"
      type="number"
      placeholder="分为几组"
      step="1"
      min="1"
    />
    <br />
    <button onclick="doGroup()">分组</button>
    <div id="result"></div>
  </body>
  <script>
    document.getElementById("users").value = `张三
李四
王五
赵六
钱七
孙八
李九
周一
五二
郑玲`;
    function doGroup() {
      const arr = document.getElementById("users").value.split("\n");
      document.getElementById("result").innerHTML = "";
      let group = Number(document.getElementById("group").value);
      let t = Math.floor(arr.length / group);
      let left = arr.length % group;

      const result = [];
      const used = {};
      let total = 0;
      for (let i = 0; i < group; i++) {
        const groupu = [];
        for (let j = 0; j < t; j++) {
          if (total >= arr.length) {
            break;
          }
          let r = getRandom(0, arr.length - 1);
          while (used["_" + r] != null) {
            r = getRandom(0, 10);
          }
          used["_" + r] = true;
          groupu[j] = arr[r];
          total++;
        }
        const li = document.createElement("li");
        li.innerText = `分组：${groupu.join("，")}`;
        document.getElementById("result").appendChild(li);
        result.push(groupu);
      }
      if (left > 0) {
        const groupu = [];
        for (let j = 0; j < left; j++) {
          if (total >= arr.length) {
            break;
          }
          let r = getRandom(0, arr.length - 1);
          while (used["_" + r] != null) {
            r = getRandom(0, 10);
          }
          used["_" + r] = true;
          groupu[j] = arr[r];
          total++;
        }
        const li = document.createElement("li");
        li.innerText = `替补席：${groupu.join("，")}`;
        document.getElementById("result").appendChild(li);
        result.push(groupu);
      }
    }

    function getRandom(start, end) {
      return Math.floor(Math.random() * (end - start) + start);
    }
  </script>
</html>
